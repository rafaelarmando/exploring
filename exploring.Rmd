---
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load the necessary libraries
```{r}
library(tidyverse)
```

### Variation

Perform an analysis of the variation in the "neighbourhood" column. 

```{r}
ggplot(data = listings) + geom_bar(mapping = aes(x = neighbourhood))

listings %>%
  count(neighbourhood) %>%
  arrange(desc(n))
```

* Which values are the most common? Why?


* Which values are rare? Why? Does that match your expectations?


* Can you see any unusual patterns? What might explain them?



Perform an analysis of the variation in the "room_type" column. 

```{r}
ggplot(listings) + geom_bar(mapping = aes(x = room_type))

listings %>%
  count(room_type) %>%
  arrange(desc(n))
```

* Which values are the most common? Why?


* Which values are rare? Why? Does that match your expectations?


* Can you see any unusual patterns? What might explain them?



Perform an analysis of the variation in the "price" column. Make sure to explore different "binwidth" values in your analysis.

```{r}
ggplot(listings) + geom_histogram(mapping = aes(x = price), binwidth = 25)

#zoomed-in
ggplot(listings) + geom_histogram(mapping = aes(x = price), binwidth = 25) + 
  coord_cartesian(xlim = c(0, 1000))

listings %>%
  count(price) %>%
  arrange(desc(n))

listings %>%
  count(price) %>%
  arrange(desc(price))
```

* Which values are the most common? Why?


* Which values are rare? Why? Does that match your expectations?


* Can you see any unusual patterns? What might explain them?



Perform an analysis of the variation in the "minimum_nights" column. Make sure to explore different "binwidth" values in your analysis.

```{r}
ggplot(listings) + geom_histogram(mapping = aes(x = minimum_nights), binwidth = 1)

#zoomed-in
ggplot(listings) + geom_histogram(mapping = aes(x = minimum_nights), binwidth = 1) + 
  coord_cartesian(xlim = c(0, 100))

listings %>%
  count(minimum_nights) %>%
  arrange(desc(n))

listings %>%
  count(minimum_nights) %>%
  arrange(desc(minimum_nights))
```

* Which values are the most common? Why?


* Which values are rare? Why? Does that match your expectations?


* Can you see any unusual patterns? What might explain them?



Perform an analysis of the variation in the "number_of_reviews" column. Make sure to explore different "binwidth" values in your analysis.

```{r}
ggplot(listings) + geom_histogram(mapping = aes(x = number_of_reviews), binwidth = 1)

#zoomed-in x axis
ggplot(listings) + geom_histogram(mapping = aes(x = number_of_reviews), binwidth = 1) + 
  coord_cartesian(xlim = c(0, 350))

#zoomed-in x and y axis
ggplot(listings) + geom_histogram(mapping = aes(x = number_of_reviews), binwidth = 1) + 
  coord_cartesian(xlim = c(0, 350), ylim = c(0, 500))

listings %>%
  count(number_of_reviews) %>%
  arrange(desc(n))

listings %>%
  count(number_of_reviews) %>%
  arrange(desc(number_of_reviews))
```

* Which values are the most common? Why?


* Which values are rare? Why? Does that match your expectations?


* Can you see any unusual patterns? What might explain them?



Perform an analysis of the variation in the "availability_365" column. Make sure to explore different "binwidth" values in your analysis.

```{r}
ggplot(listings) + geom_histogram(mapping = aes(x = availability_365), binwidth = 1)

#zoomed-in x axis
ggplot(listings) + geom_histogram(mapping = aes(x = availability_365), binwidth = 1) + 
  coord_cartesian(ylim = c(0, 500))

listings %>%
  count(availability_365) %>%
  arrange(desc(n))

listings %>%
  count(availability_365) %>%
  arrange(desc(availability_365))
```

* Which values are the most common? Why?


* Which values are rare? Why? Does that match your expectations?


* Can you see any unusual patterns? What might explain them?

Most common name?

```{r}
listings %>%
  count(host_name) %>%
  arrange(desc(n))
```

```{r}
#accounting for all values
ggplot(data = listings, mapping = aes(x = number_of_reviews, y = price)) + geom_point() + geom_smooth(se = FALSE) + coord_cartesian(ylim = c(0, 3000))

#not accounting for expensive places
under_one_thousand <- listings %>%
  filter(price < 1000)

  ggplot(data = under_one_thousand, mapping = aes(x = number_of_reviews, y = price)) + geom_point() + geom_smooth(se = FALSE)
```

```{r}
ggplot(data = listings) +
  geom_boxplot(mapping = aes(x = reorder(room_type, price, FUN = median), y = price))

ggplot(data = under_one_thousand) +
  geom_boxplot(mapping = aes(x = reorder(room_type, price, FUN = median), y = price))
```

```{r}
ggplot(data = listings) +
  geom_boxplot(mapping = aes(x = reorder(room_type, number_of_reviews, FUN = median), y = number_of_reviews))

ggplot(data = under_one_thousand) +
  geom_boxplot(mapping = aes(x = reorder(room_type, number_of_reviews, FUN = median), y = number_of_reviews))
```

```{r}
ggplot(data = listings) +
  geom_boxplot(mapping = aes(x = reorder(neighbourhood, price, FUN = median), y = price)) + coord_flip()

by_neighborhood <- group_by(listings, neighbourhood) %>%
  summarize(avg_price = mean(price)) %>%
  arrange(desc(avg_price))

by_neighborhood
```

```{r}
by_n_rt <- listings %>%
  group_by(neighbourhood, room_type) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

by_n_rt
```

If you could own a house in that city, that you could rent as an airbnb, where would it be, and why? find a home in that neighborhood, what is its price? what is the average airbnb price in that neighborhood? what is the average availability of an airbnb in that neighborhood? If you were to buy that house and rent it as an airbnb using these average values, how long would it take you to break even?



